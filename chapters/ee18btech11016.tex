\begin{enumerate}[label=\thesection.\arabic*.,ref=\thesection.\theenumi]
\numberwithin{equation}{enumi} 
\item
 
The open loop transfer function of a feedback control system is  
\begin{align}
G(s) = \frac{1}{s(1+2s)(1+s)} 
\end{align}
Find the gain margin of this system and analyse the stability.
 \\


\solution
\\
\textbf{Gain Margin}:The greater the Gain Margin (GM), the greater the stability of the system. The gain margin refers to the amount of gain, which can be increased or decreased without making the system unstable. It is usually expressed as a magnitude in dB.
\\

We can usually read the gain margin directly from the Bode plot. This is done by calculating the vertical distance between the magnitude curve (on the Bode magnitude plot) and the x-axis at the frequency where the Bode phase plot = 180$^{\circ}$. This point is known as the phase crossover frequency.

Gain Margin is given by,
\begin{align}
G.M = -20log_{10}|G(j\omega_{pc})| = 20log_{10}k_{g}
\end{align}
where 
\begin{align}
k_{g}=\frac{1}{|G(j\omega_{pc})|} 
\end{align}
\\

Now let's put s = j$\omega$ in the equation of G(s) :
\begin{align}
G(j\omega) = \frac{1}{j\omega(1+2j\omega)(1+j\omega)} 
\end{align}
So,
\begin{align}
G(j\omega) = \frac{1}{j\omega(1+3j\omega-2\omega^2)}=\frac{1}{j\omega-3\omega^2-2j\omega^3}
\end{align}
Hence ,
\begin{align}
G(j\omega) = \frac{1}{-3\omega^2+j\omega(1-2\omega^2)} 
\end{align}

Now we know that $\omega_{pc}$ is the Phase crossover frequency (The frequency at which the phase of open-loop transfer function reaches -180$^{\circ}$ or +180$^{\circ}$ depending upon the range of tan inverse function).\\
Now,
\begin{align}
\angle G(j\omega)=- tan^{-1}(\frac{\omega(1-2\omega^2)}{-3\omega^2})
\end{align}
So,at $\omega=\omega_{pc}$ :
\begin{align}
\omega(1-2\omega^2) = 0 
\end{align}
i.e. the imaginary part of G(j$\omega$) = 0.So ,
\begin{align}
\omega_{pc} = \frac{1}{\sqrt{2}} 
\end{align}
as $\omega_{pc}$ should be positive and $\omega_{pc}$ shuld not be equal to zero.So now G(j$\omega_{pc}$) will be :
\begin{align}
G(j\omega_{pc}) = \frac{1}{-3\omega_{pc}^2}
\end{align}
i.e,
\begin{align}
|G(j\omega_{pc})| = \frac{1}{(\frac{3}{2})}
\end{align}
\begin{align}
k_{g}=\frac{1}{|G(j\omega_{pc})|} = \frac{3}{2}=1.5
\end{align}
So , Gain margin in terms of dB is :

\begin{align}
20log_{10}1.5 = 3.5dB
\end{align}
\\

Plot obtained for verification in python :

(You can download code from codes/ee18btech11016.py)
\begin{figure}[htp]
	\centering
	\includegraphics[width=\columnwidth,scale=2]{./figs/fig.eps}
	\caption{}
	\label{fig:Phase}
\end{figure}
\\

\section{Stability}

So,in the above figure, since $20log_{10}(G(j\omega_{pc}))$ = -3.5dB at $\omega_{pc} = -180^{\circ}$ so G.M = +3.5dB And since the gain margin is positive we can say that the system is stable more precisely the system is marginally stable as one of the pole lies on the imaginary axis.(Because for stability , both gain and phase margin should be positive.)
\\

\textbf{Analysis}:
Now,Let's try to analyse the stabilty of the system using Routh-Hurwitz Criterion :
\\

Let $T(s)$ be Closed loop transfer function ,
\begin{align}
T(s)=\frac{N(s)}{D(s)}=\frac{G(s)}{1+G(s)}
\end{align}
The characteristic equation is 
\begin{align}
D(s)=0  \\
1+G(s)=0 
\end{align}
So,the closed loop transfer function is given by 
\begin{align}
T(s) = \frac{1}{1 + (s(1+2s)(1+s))}
\end{align}

\begin{align}
=> D(s) = 1 + s(1+s)(1+2s) = 2s^3 + 3s^2 + s + 1 
\end{align}
\\
So,the characteristics equation is given by D(s) = 0.i.e,
\begin{align}
=> 2s^3 + 3s^2 + s + 1 = 0 
\end{align}
Constructing routh array for above equation of D(s),
\begin{align}
\mydet{s^3\\s^2\\s}
\mydet{2 & 1 & 0 \\ 3 & 1 & 0 \\ (1/3) & 0 & 0}
\end{align}\\

\begin{align}
\mydet{s^3\\s^2\\s\\s^0}
\mydet{2 & 1 & 0 \\ 3 & 1 & 0 \\ (1/3) & 0 & 0 \\ 1 & 0 & 0}
\end{align}\\


There are no sign changes in the first column of the routh array. So, no poles lie on right half of s-plane. 
\\
Therefore,the system is stable.\\

You can download the code for Routh-Hurwitz array from (codes/RH.py)
\\

Hence,we can say that from both Routh-hurwitz criterion and from the gain margin concept we are getting the same answers.

\end{enumerate}


